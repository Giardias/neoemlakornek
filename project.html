<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antalya Emlak Ä°lanlarÄ± | TÃ¼m Projelerimiz | NEO YAPI</title>
    <meta name="description" content="Antalya'da tÃ¼m emlak ilanlarÄ±. SatÄ±lÄ±k daire, villa, arsa, iÅŸyeri. En gÃ¼ncel fiyatlar, detaylÄ± bilgiler ve fotoÄŸraflar.">
    <meta name="keywords" content="Antalya satÄ±lÄ±k daire, kiralÄ±k villa, emlak ilanlarÄ±, gayrimenkul, arsa, iÅŸyeri">
    <meta name="author" content="NEO YAPI">
    
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/609/609803.png">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Antalya Emlak Ä°lanlarÄ± | TÃ¼m Projelerimiz">
    <meta property="og:description" content="Antalya'da tÃ¼m emlak ilanlarÄ±. En gÃ¼ncel fiyatlar ve detaylÄ± bilgiler.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800">
    <meta property="og:url" content="https://neoyapi.com/project.html">
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0F172A">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- NAVBAR -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <a href="index.html" class="logo" aria-label="NEO YAPI Ana Sayfa">
                NEO<span>YAPI</span>
            </a>
            <button class="menu-toggle" onclick="toggleMenu()" aria-label="Open menu" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>
            <div class="nav-links" id="navLinks" role="menubar">
                <a href="index.html" role="menuitem">VÄ°TRÄ°N</a>
                <a href="project.html" class="active" role="menuitem">PROJELER</a>
                <a href="about.html" role="menuitem">KURUMSAL</a>
                <a href="number.html" role="menuitem">Ä°LETÄ°ÅžÄ°M</a>
            </div>
        </div>
    </nav>

    <!-- HERO -->
    <header class="hero page-hero" role="banner">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1>TÃ¼m Emlak Ä°lanlarÄ±</h1>
            <p>Antalya'nÄ±n en kapsamlÄ± gayrimenkul portfÃ¶yÃ¼</p>
        </div>
    </header>
    <div>
        <br>
        <br>
    </div>
    
    <!-- STATS -->
    <div class="container">
        <div class="stats-container">
            <div class="stat-card">
                <span class="stat-number" id="totalListings">0</span>
                <span class="stat-label">Toplam Ä°lan</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="featuredListings">0</span>
                <span class="stat-label">Vitrin Ä°lanÄ±</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="activeFilter">0</span>
                <span class="stat-label">GÃ¶sterilen</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">7/24</span>
                <span class="stat-label">Destek</span>
            </div>
        </div>
    </div>

    <!-- FILTER SECTION -->
    <div class="filter-section" role="search">
        <div class="filter-group">
            <input type="text" id="searchInput" placeholder="Ä°lan Ara (Ã–rn: Lara, 3+1, havuzlu...)" 
                   onkeyup="applyFilter()" aria-label="Search listings">
        </div>
        <div class="filter-group">
            <select id="filterCategory" onchange="applyFilter()" aria-label="Filter by category">
                <option value="all">TÃ¼m Kategoriler</option>
                <option value="konut">Konut / Daire</option>
                <option value="villa">LÃ¼ks Villa</option>
                <option value="arsa">Arsa / Arazi</option>
                <option value="isyeri">Ticari / Ä°ÅŸyeri</option>
            </select>
        </div>
        <div class="filter-group">
            <select id="filterSort" onchange="applyFilter()" aria-label="Sort listings">
                <option value="new">En Yeniler</option>
                <option value="price-asc">Fiyat: DÃ¼ÅŸÃ¼kten YÃ¼kseÄŸe</option>
                <option value="price-desc">Fiyat: YÃ¼ksekten DÃ¼ÅŸÃ¼ÄŸe</option>
                <option value="featured">Ã–nce Vitrinler</option>
            </select>
        </div>
        <button class="btn-filter" onclick="applyFilter()" aria-label="Apply filters">
            <i class="fas fa-search"></i> ARA
        </button>
    </div>

    <!-- CATEGORY QUICK FILTER -->
    <div class="container">
        <div class="category-filter" role="group" aria-label="Quick category filters">
            <button class="category-btn active" data-category="all" onclick="filterByCategory('all')">
                <i class="fas fa-layer-group"></i> TÃ¼mÃ¼
            </button>
            <button class="category-btn" data-category="konut" onclick="filterByCategory('konut')">
                <i class="fas fa-home"></i> Konut
            </button>
            <button class="category-btn" data-category="villa" onclick="filterByCategory('villa')">
                <i class="fas fa-crown"></i> Villa
            </button>
            <button class="category-btn" data-category="arsa" onclick="filterByCategory('arsa')">
                <i class="fas fa-mountain"></i> Arsa
            </button>
            <button class="category-btn" data-category="isyeri" onclick="filterByCategory('isyeri')">
                <i class="fas fa-store"></i> Ä°ÅŸyeri
            </button>
            <button class="category-btn" data-category="featured" onclick="filterByCategory('featured')">
                <i class="fas fa-star"></i> Vitrin
            </button>
        </div>
    </div>

    <!-- ALL LISTINGS -->
    <section class="container" aria-labelledby="listings-title">
        <div class="page-header">
            <h2 id="listings-title" class="page-title">TÃ¼m Emlak PortfÃ¶yÃ¼mÃ¼z</h2>
            <p class="page-subtitle" id="resultCountLabel">Ä°lanlar yÃ¼kleniyor...</p>
        </div>
        
        <div class="grid" id="projectGrid" role="list" aria-label="Property listings">
            <div class="loading-placeholder">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Ä°lanlar yÃ¼kleniyor...</p>
            </div>
        </div>
        
        <!-- EMPTY STATE -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <i class="fas fa-search"></i>
            <h3>Ä°lan BulunamadÄ±</h3>
            <p>Arama kriterlerinize uygun ilan bulunamadÄ±. LÃ¼tfen farklÄ± bir filtre deneyin.</p>
            <button class="btn-filter" onclick="clearFilters()" style="margin-top: var(--space-lg);">
                <i class="fas fa-times"></i> Filtreleri Temizle
            </button>
        </div>
    </section>

    <!-- WHATSAPP BUTTON -->
    <a href="https://wa.me/905321002030?text=Merhaba,%20NEO%20YAPI%20ilanlarÄ±nÄ±z%20hakkÄ±nda%20bilgi%20almak%20istiyorum." 
       target="_blank" 
       class="whatsapp-float"
       aria-label="Contact via WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- FOOTER -->
    <footer style="background: #0F172A; color: #94A3B8; padding: 60px 0; margin-top: 50px;" role="contentinfo">
        <div class="container" style="text-align: center;">
            <h2 style="font-family: 'Playfair Display', serif; color: white; margin-bottom: 20px;">NEO YAPI</h2>
            <p style="max-width: 600px; margin: 0 auto 30px;">Kalite, gÃ¼ven ve ÅŸeffaflÄ±k ilkeleriyle Antalya'da gayrimenkul sektÃ¶rÃ¼nde fark yaratÄ±yoruz.</p>
            <div style="font-size: 24px; display: flex; justify-content: center; gap: 20px; margin-bottom: 30px;">
                <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                <a href="https://wa.me/905321002030" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
            </div>
            <p style="font-size: 14px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
                Â© 2026 NEO YAPI A.Åž. TÃ¼m haklarÄ± saklÄ±dÄ±r. | 
            </p>
        </div>
    </footer>

    <!-- MODAL -->
    <div id="detailModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-window">
            <button class="close-btn" onclick="closeModal()" aria-label="Close modal">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="modal-left">
                <button class="slider-btn prev" onclick="changeSlide(-1)" aria-label="Previous image">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <img id="m-img" src="" class="modal-img" alt="Listing image">
                <button class="slider-btn next" onclick="changeSlide(1)" aria-label="Next image">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div id="m-count" class="img-counter">1 / 1</div>
            </div>

            <div class="modal-right">
                <div class="modal-header">
                    <h2 id="m-title">Ä°lan BaÅŸlÄ±ÄŸÄ±</h2>
                    <span id="m-loc" style="color:#64748B; font-weight:600;">
                        <i class="fas fa-map-marker-alt"></i> Konum
                    </span>
                </div>
                
                <div class="modal-price" id="m-price" style="font-size:32px; font-weight:800; color:#C5A059; margin: 20px 0;">
                    0 â‚º
                </div>
                
                <div id="m-specs"></div>
                
                <h4 style="color:#0F172A; margin-bottom:10px;">AÃ§Ä±klama</h4>
                <p id="m-desc" style="font-size:14px; color:#475569; line-height:1.7; margin-bottom: 20px;"></p>
                
                <div id="m-tags" style="margin-bottom: 20px;"></div>
                
                <h4 style="color:#0F172A; margin-bottom:10px;">Konum</h4>
                <div id="modal-map" style="width: 100%; height: 250px; border-radius: 12px; margin-bottom: 20px; overflow: hidden; border: 1px solid #E2E8F0; background:#eee;" 
                     role="region" aria-label="Property location map"></div>
                
                <!-- ACTION BUTTONS -->
                <div class="action-buttons" style="display: flex; gap: 10px; margin-top: 20px;">
                    <a href="https://wa.me/905321002030" 
                       target="_blank" 
                       style="flex:1; background:#25D366; color:white; padding:15px; text-align:center; border-radius:8px; font-weight:700; text-decoration:none;"
                       aria-label="Contact via WhatsApp about this listing">
                        <i class="fab fa-whatsapp"></i> WhatsApp'tan Sor
                    </a>
                    <button onclick="closeModal()" 
                            style="flex:1; background:#64748B; color:white; border:none; padding:15px; border-radius:8px; font-weight:700; cursor:pointer;"
                            aria-label="Close details">
                        Kapat
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Firebase Configuration - UPDATE THIS!
        const firebaseConfig = {
            apiKey: "AIzaSyBF5hsTqXl5hSJk3z-_kuECRrQzaVl-aj8",
            authDomain: "neoproject-e1cdd.firebaseapp.com",
            databaseURL: "https://neoproject-e1cdd-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "neoproject-e1cdd",
            storageBucket: "neoproject-e1cdd.firebasestorage.app",
            messagingSenderId: "900464535576",
            appId: "1:900464535576:web:5182d851532d84d21ffb6d",
            measurementId: "G-C47VH3DEDG"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Application State
        let allListings = [];
        let filteredListings = [];
        let currentListing = null;
        let currentSlideIndex = 0;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log("ðŸ“Š Projeler sayfasÄ± yÃ¼klendi");
            loadListingsFromFirebase();
            setupEventListeners();
            
            // Add optimized-card class
            setTimeout(() => {
                document.querySelectorAll('.card').forEach(card => {
                    card.classList.add('optimized-card');
                });
            }, 500);
        });

        // Load from Firebase
        function loadListingsFromFirebase() {
            const listingsRef = ref(db, 'listings');
            
            onValue(listingsRef, (snapshot) => {
                const data = snapshot.val();
                allListings = [];
                
                if (data && Object.keys(data).length > 0) {
                    Object.keys(data).forEach(key => {
                        allListings.push({ id: key, ...data[key] });
                    });
                    console.log(`âœ… ${allListings.length} ilan yÃ¼klendi`);
                } else {
                    // Fallback to enhanced sample data
                    allListings = getSampleListings();
                    console.log("â„¹ï¸ Ã–rnek ilanlar gÃ¶steriliyor");
                }
                
                updateUI();
                
            }, (error) => {
                console.error("âš ï¸ Firebase hatasÄ±:", error);
                allListings = getSampleListings();
                updateUI();
            });
        }

        // Enhanced Sample Data
        function getSampleListings() {
            return [
                {
                    id: "ex1",
                    title: "Lara'da Deniz ManzaralÄ± LÃ¼ks 4+1 Daire",
                    price: "18.500.000 â‚º",
                    loc: "MuratpaÅŸa, Lara",
                    category: "konut",
                    images: [
                        "https://images.unsplash.com/photo-1512918728675-ed5a9ecdebfd?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1484101403633-562f891dc89a?w=800&auto=format&fit=crop&q=80"
                    ],
                    details: { m2: "220", oda: "4+1", kat: "8. Kat", banyo: "2", yas: "SÄ±fÄ±r", isinma: "Merkezi DoÄŸalgaz" },
                    desc: "Lara bÃ¶lgesinde, denize sÄ±fÄ±r konumda, ferah ve aydÄ±nlÄ±k 4+1 lÃ¼ks daire. YÃ¼ksek kaliteli malzemeler, geniÅŸ balkon, kapalÄ± otopark, 24 saat gÃ¼venlik.",
                    featured: true,
                    tags: ["deniz-manzaralÄ±", "lÃ¼ks", "otopark", "gÃ¼venlik"]
                },
                {
                    id: "ex2",
                    title: "KonyaaltÄ±'nda Havuzlu Site Ä°Ã§i 3+1",
                    price: "9.750.000 â‚º",
                    loc: "KonyaaltÄ±, Liman",
                    category: "konut",
                    images: [
                        "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1484154218962-a1c002085aac?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800&auto=format&fit=crop&q=80"
                    ],
                    details: { m2: "140", oda: "3+1", kat: "3. Kat", banyo: "1", yas: "5 YaÅŸÄ±nda", isinma: "Klima" },
                    desc: "KonyaaltÄ± sahiline yÃ¼rÃ¼me mesafesinde, yÃ¼zme havuzlu, fitness salonlu, 24 saat gÃ¼venlikli sitede ferah 3+1 daire. GeniÅŸ balkon, Amerikan mutfak.",
                    featured: true,
                    tags: ["site-iÃ§i", "havuz", "fitness", "sahil-yakÄ±nÄ±"]
                },
                {
                    id: "ex3",
                    title: "YeÅŸilbayÄ±r'da Ã–zel Havuzlu Villa",
                    price: "32.000.000 â‚º",
                    loc: "DÃ¶ÅŸemealtÄ±, YeÅŸilbayÄ±r",
                    category: "villa",
                    images: [
                        "https://images.unsplash.com/photo-1613977257363-707ba9348227?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1513584684374-8bab748fbf90?w=800&auto=format&fit=crop&q=80"
                    ],
                    details: { m2: "450", oda: "6+1", kat: "Triplex", banyo: "4", yas: "SÄ±fÄ±r", isinma: "Yerden IsÄ±tma" },
                    desc: "1000mÂ² bahÃ§e iÃ§inde, Ã¶zel yÃ¼zme havuzlu, akÄ±llÄ± ev sistemi, gÃ¼neÅŸ enerjili, doÄŸalgazlÄ± ultra lÃ¼ks villa. 5 yatak odasÄ±, sinema odasÄ±, ÅŸÃ¶mine.",
                    featured: true,
                    tags: ["havuzlu", "bahÃ§eli", "akÄ±llÄ±-ev", "lÃ¼ks"]
                },
                {
                    id: "ex4",
                    title: "AltÄ±nkale'de Ä°marlÄ± Arsa",
                    price: "8.500.000 â‚º",
                    loc: "DÃ¶ÅŸemealtÄ±, AltÄ±nkale",
                    category: "arsa",
                    images: [
                        "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1580582932707-520aed937b7b?w=800&auto=format&fit=crop&q=80"
                    ],
                    details: { m2: "500", oda: "-", kat: "-", banyo: "-", yas: "-", isinma: "-" },
                    desc: "Villa imarlÄ±, kÃ¶ÅŸe parsel, altyapÄ±sÄ± hazÄ±r, hemen inÅŸaata uygun fÄ±rsat arsa. Elektrik, su, kanalizasyon mevcut. 0.60 emsal.",
                    featured: false,
                    tags: ["imarli", "kÃ¶ÅŸe-parsel", "altyapÄ±-hazÄ±r"]
                },
                {
                    id: "ex5",
                    title: "IÅŸÄ±klar'da Cadde Ãœzeri DÃ¼kkan",
                    price: "12.000.000 â‚º",
                    loc: "MuratpaÅŸa, IÅŸÄ±klar",
                    category: "isyeri",
                    images: [
                        "https://images.unsplash.com/photo-1497366216548-37526070297c?w=800&auto=format&fit=crop&q=80",
                        "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800&auto=format&fit=crop&q=80"
                    ],
                    details: { m2: "150", oda: "-", kat: "Zemin Kat", banyo: "1", yas: "10 YaÅŸÄ±nda", isinma: "Klima" },
                    desc: "Ana caddede, yÃ¼ksek mÃ¼ÅŸteri trafiÄŸine sahip, geniÅŸ vitrinli, depolu dÃ¼kkan. Uzun sÃ¼reli kiracÄ±lÄ±, yÃ¼ksek kira getirisi.",
                    featured: false,
                    tags: ["ticari", "ana-cadde", "yÃ¼ksek-getiri"]
                }
            ];
        }

        // Setup Event Listeners
        function setupEventListeners() {
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft' && document.getElementById('detailModal').classList.contains('active')) {
                    changeSlide(-1);
                }
                if (e.key === 'ArrowRight' && document.getElementById('detailModal').classList.contains('active')) {
                    changeSlide(1);
                }
            });
            
            // Close modal on outside click
            window.onclick = (e) => {
                if (e.target === document.getElementById('detailModal')) {
                    closeModal();
                }
            }
        }

        // Update UI
        function updateUI() {
            filteredListings = [...allListings];
            
            // Update stats
            document.getElementById('totalListings').textContent = allListings.length;
            document.getElementById('featuredListings').textContent = allListings.filter(l => l.featured).length;
            document.getElementById('activeFilter').textContent = filteredListings.length;
            
            // Render listings
            renderListings();
            
            // Update result count
            document.getElementById('resultCountLabel').textContent = 
                `${filteredListings.length} ilan listeleniyor`;
            
            // Hide/show empty state
            const emptyState = document.getElementById('emptyState');
            if (filteredListings.length === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
        }

        // Render listings to grid
        function renderListings() {
            const container = document.getElementById('projectGrid');
            if (!container) return;
            
            if (filteredListings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <h3>Ä°lan BulunamadÄ±</h3>
                        <p>Arama kriterlerinize uygun ilan bulunamadÄ±.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredListings.map((listing, index) => {
                const img = listing.images && listing.images.length > 0 
                    ? listing.images[0] 
                    : 'https://via.placeholder.com/400x300/0F172A/FFFFFF?text=NEO+YAPI';
                
                const featuredBadge = listing.featured 
                    ? '<span class="featured-badge" style="position:absolute; top:10px; right:10px; background:#C5A059; color:white; padding:6px 12px; border-radius:20px; font-size:11px; font-weight:700; z-index:5;"><i class="fas fa-star"></i> VÄ°TRÄ°N</span>' 
                    : '';
                
                const tagClass = getTagClass(listing.category);
                
                return `
                    <article class="card optimized-card" onclick="openModal('${listing.id}')" 
                             style="animation-delay: ${index * 0.05}s" data-id="${listing.id}">
                        <div class="card-img-wrap">
                            <img src="${img}" alt="${listing.title} - ${listing.loc}" loading="lazy">
                            ${featuredBadge}
                            <span class="tag ${tagClass}">${listing.category.toUpperCase()}</span>
                            <div class="overlay"><i class="fas fa-search-plus"></i> Ä°NCELE</div>
                        </div>
                        <div class="card-body">
                            <div class="price">${listing.price}</div>
                            <h3 class="title">${listing.title}</h3>
                            <p class="loc"><i class="fas fa-map-marker-alt"></i> ${listing.loc}</p>
                            <div class="specs">
                                <span><i class="fas fa-ruler-combined"></i> ${listing.details?.m2 || '-'} mÂ²</span>
                                <span><i class="fas fa-bed"></i> ${listing.details?.oda || '-'}</span>
                                <span><i class="fas fa-layer-group"></i> ${listing.details?.kat || '-'}</span>
                            </div>
                            <button class="btn-card">DETAYLAR</button>
                        </div>
                    </article>
                `;
            }).join('');
        }

        // Get tag class
        function getTagClass(category) {
            const classes = {
                'konut': 'tag-green',
                'villa': 'tag-gold',
                'arsa': 'tag-navy',
                'isyeri': 'tag-red'
            };
            return classes[category] || 'tag-gold';
        }

        // Filter by category (quick filter)
        window.filterByCategory = function(category) {
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) {
                    btn.classList.add('active');
                }
            });
            
            // Update filter dropdown
            if (category !== 'featured') {
                document.getElementById('filterCategory').value = category;
            }
            
            // Apply filter
            applyFilter();
        };

        // Apply filters
        window.applyFilter = function() {
            const search = document.getElementById('searchInput')?.value.toLowerCase() || '';
            const category = document.getElementById('filterCategory')?.value || 'all';
            const sort = document.getElementById('filterSort')?.value || 'new';
            
            filteredListings = allListings.filter(listing => {
                const matchesSearch = listing.title.toLowerCase().includes(search) || 
                                    listing.loc.toLowerCase().includes(search) ||
                                    (listing.desc && listing.desc.toLowerCase().includes(search)) ||
                                    (listing.tags && listing.tags.some(tag => tag.includes(search)));
                
                const matchesCategory = category === 'all' || listing.category === category;
                
                return matchesSearch && matchesCategory;
            });
            
            // Apply sorting
            if (sort === 'price-asc') {
                filteredListings.sort((a, b) => {
                    const priceA = parseInt(a.price.replace(/[^0-9]/g, '')) || 0;
                    const priceB = parseInt(b.price.replace(/[^0-9]/g, '')) || 0;
                    return priceA - priceB;
                });
            } else if (sort === 'price-desc') {
                filteredListings.sort((a, b) => {
                    const priceA = parseInt(a.price.replace(/[^0-9]/g, '')) || 0;
                    const priceB = parseInt(b.price.replace(/[^0-9]/g, '')) || 0;
                    return priceB - priceA;
                });
            } else if (sort === 'featured') {
                filteredListings.sort((a, b) => {
                    if (a.featured && !b.featured) return -1;
                    if (!a.featured && b.featured) return 1;
                    return 0;
                });
            }
            
            // Update UI
            renderListings();
            document.getElementById('activeFilter').textContent = filteredListings.length;
            document.getElementById('resultCountLabel').textContent = 
                `${filteredListings.length} ilan bulundu`;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            if (filteredListings.length === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
        };

        // Clear all filters
        window.clearFilters = function() {
            document.getElementById('searchInput').value = '';
            document.getElementById('filterCategory').value = 'all';
            document.getElementById('filterSort').value = 'new';
            
            // Reset category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === 'all') {
                    btn.classList.add('active');
                }
            });
            
            applyFilter();
        };

        // Modal Functions
        window.openModal = function(listingId) {
            const listing = allListings.find(l => l.id === listingId);
            if (!listing) return;
            
            currentListing = listing;
            currentSlideIndex = 0;
            
            const modal = document.getElementById('detailModal');
            if (!modal) return;
            
            // Update modal content
            document.getElementById('m-title').textContent = listing.title;
            document.getElementById('m-loc').innerHTML = `<i class="fas fa-map-marker-alt"></i> ${listing.loc}`;
            document.getElementById('m-price').textContent = listing.price;
            document.getElementById('m-desc').textContent = listing.desc;
            
            // Update specifications
            document.getElementById('m-specs').innerHTML = `
                <div class="spec-grid">
                    <div class="spec-item">
                        <i class="fas fa-ruler-combined" style="color:#C5A059;"></i>
                        <span>ALAN</span>
                        <strong>${listing.details?.m2 || '-'} mÂ²</strong>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-bed" style="color:#C5A059;"></i>
                        <span>ODA</span>
                        <strong>${listing.details?.oda || '-'}</strong>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-layer-group" style="color:#C5A059;"></i>
                        <span>KAT</span>
                        <strong>${listing.details?.kat || '-'}</strong>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-bath" style="color:#C5A059;"></i>
                        <span>BANYO</span>
                        <strong>${listing.details?.banyo || '-'}</strong>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-calendar-alt" style="color:#C5A059;"></i>
                        <span>YAÅž</span>
                        <strong>${listing.details?.yas || '-'}</strong>
                    </div>
                    <div class="spec-item">
                        <i class="fas fa-fire" style="color:#C5A059;"></i>
                        <span>ISINMA</span>
                        <strong>${listing.details?.isinma || '-'}</strong>
                    </div>
                </div>
            `;
            
            // Update tags
            const tagsContainer = document.getElementById('m-tags');
            if (listing.tags && listing.tags.length > 0) {
                tagsContainer.innerHTML = `
                    <div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 15px 0;">
                        ${listing.tags.map(tag => 
                            `<span style="background: #F1F5F9; color: #475569; padding: 5px 10px; border-radius: 20px; font-size: 12px; font-weight: 600;">#${tag}</span>`
                        ).join('')}
                    </div>
                `;
            } else {
                tagsContainer.innerHTML = '';
            }
            
            // Update images
            if (listing.images && listing.images.length > 0) {
                document.getElementById('m-img').src = listing.images[0];
                document.getElementById('m-count').textContent = `1 / ${listing.images.length}`;
            }
            
            // Update map
            const query = encodeURIComponent(listing.loc + ', Antalya');
            document.getElementById('modal-map').innerHTML = `
                <iframe 
                    width="100%" height="100%" frameborder="0" style="border:0" 
                    src="https://maps.google.com/maps?q=${query}&t=&z=14&ie=UTF8&iwloc=&output=embed"
                    loading="lazy"
                    title="${listing.title} konumu">
                </iframe>
            `;
            
            // Update WhatsApp link
            const whatsappBtn = document.querySelector('.action-buttons a[href*="whatsapp"]');
            if (whatsappBtn) {
                const message = `Merhaba, ${encodeURIComponent(listing.title)} (${listing.price}) ilanÄ± hakkÄ±nda bilgi almak istiyorum.`;
                whatsappBtn.href = `https://wa.me/905321002030?text=${encodeURIComponent(message)}`;
            }
            
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        };

        window.closeModal = function() {
            document.getElementById('detailModal').classList.remove('active');
            document.getElementById('detailModal').setAttribute('aria-hidden', 'true');
            document.body.style.overflow = 'auto';
        };

        window.changeSlide = function(direction) {
            if (!currentListing || !currentListing.images || currentListing.images.length <= 1) return;
            
            currentSlideIndex += direction;
            
            if (currentSlideIndex < 0) {
                currentSlideIndex = currentListing.images.length - 1;
            } else if (currentSlideIndex >= currentListing.images.length) {
                currentSlideIndex = 0;
            }
            
            document.getElementById('m-img').src = currentListing.images[currentSlideIndex];
            document.getElementById('m-count').textContent = `${currentSlideIndex + 1} / ${currentListing.images.length}`;
        };

        // Mobile Menu
        window.toggleMenu = function() {
            const navLinks = document.getElementById('navLinks');
            const isExpanded = navLinks.classList.toggle('active');
            document.querySelector('.menu-toggle').setAttribute('aria-expanded', isExpanded);
        };
    </script>
</body>
</html>